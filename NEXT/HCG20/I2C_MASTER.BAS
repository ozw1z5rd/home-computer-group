REM 
REM I2C TIME SERVER DEMO / MASTER 
REM

REM 
REM THIS IS THE MESSAGE SENT TO THE SLAVE
REM 
M$="TEST MESSAGE"

REM
REM ASSIGN THE PINS TO THE I2C INTERFACE, SEE TABLE
REM FOR THEN ALLOWED ONE
REM 
SetPin GP4, GP5, I2C

REM 
REM OPENS A I2C DEVICE WITH 100KHZ CLOCK AND
REM 2SECONDS TIMEOUT
REM 
I2C OPEN 100, 2000

REM 
REM MASTER SEND A MESSAGE TO THE SLAVE RESPONDING
REM AS ADDRESS $50
REM MM.I2C CONTAINS THE STATUS OF THE LAST OPERATION
REM
Print "MASTER -> SLAVE "
I2C WRITE &H50, 0, Len(M$), M$
Print "STATUS:", MM.I2C
Pause 500

REM 
REM READ DATA FROM THE SLAVE AT ADDRESS $50
REM THE EXPECTED NUMBER OF BYTE IS SUPPOSED TO
REM BE KNOWN BEFORE THE READ HAPPENS
REM
M$=""
Print "MASTER <- SLAVE "
I2C READ &H50, 0, 8, M$
Print "STATUS:", MM.I2C
Pause 500
Print M$

